---
title: "Homebrew ã§ python3 ç”¨ã® Boost.Python ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹"
date: 2017-09-15T18:34:38+09:00
draft: false
categories: [ "ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°" ]
tags: [ "C++", "python", "boost", "homebrew" ]
---

```console
$ brew install boost-python --with-python3
```

ãªã®ã ãŒã€ã™ã“ã—ãƒãƒã‚Šã©ã“ã‚ãŒã‚ã‚‹ã€‚

## brew install boost-python ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³

`brew install` ã«ã¯ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æŒ‡å®šã§ãã‚‹å ´åˆãŒã‚ã‚‹ã€‚<br />
boost-python ã®å ´åˆã¯ `--with-python3` ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒä½¿ãˆã‚‹ã€‚

`brew options` ã§ä½¿ç”¨å¯èƒ½ãªã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ã™ã¹ã¦è¡¨ç¤ºã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚

```console
$ brew options boost-python
--c++11
	Build using C++11 mode
--with-python3
	Build with python3 support
--without-python
	Build without python 2 support
--HEAD
	Install HEAD version
```

`--with-python3` ã‚’æŒ‡å®šã—ãŸå ´åˆã€`boost-python` ã¯ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‹ã‚‰ãƒ“ãƒ«ãƒ‰ã•ã‚Œã‚‹ã€‚

## ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ‰‹é †

Homebrew ã® formula ã¯ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®ã‚ã‚Šãƒ»ãªã—ã«é–¢ã‚ã‚‰ãšé‡è¤‡ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ããªã„ã®ã§ã€
ã™ã§ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã„ã‚‹å ´åˆã¯ã¯ã˜ã‚ã«ã‚¢ãƒ³ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã€‚

```console
$ # macOS Sierra (10.12) + Homebrew
$ # ãŠã“ã‚‰ã‚Œã‚‹
$ brew install boost-python --with-python3
Warning: boost-python 1.65.1 is already installed
$
$ # ã¯ã˜ã‚ã«ã‚¢ãƒ³ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
$ brew uninstall boost-python
Uninstalling /usr/local/Cellar/boost-python/1.65.1... (457 files, 16MB)
$
$ # ---------------------------------------------------------------------------
$ # * ã“ã®å‡¦ç†ã¯å®Ÿéš›ã¯ä¸è¦ã§ã™
$ # ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãªã—ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆå‚è€ƒï¼‰ã€‚ãƒ“ãƒ«ãƒ‰æ¸ˆã¿ãƒã‚¤ãƒŠãƒªãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã‚‹ã€‚
$ brew install boost-python
==> Downloading https://homebrew.bintray.com/bottles/boost-python-1.65.1.sierra.bottle.tar.gz
==> Pouring boost-python-1.65.1.sierra.bottle.tar.gz
ğŸº  /usr/local/Cellar/boost-python/1.65.1: 457 files, 16MB
$
$ # ãµãŸãŸã³ã‚¢ãƒ³ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
$ brew uninstall boost-python
Uninstalling /usr/local/Cellar/boost-python/1.65.1... (457 files, 16MB)
$ # ---------------------------------------------------------------------------
$
$ # python3 ç‰ˆã‚’ãƒ“ãƒ«ãƒ‰ã—ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹
$ brew install boost-python --with-python3
==> Downloading https://dl.bintray.com/boostorg/release/1.65.1/source/boost_1_65_1.tar.bz2
==> ./bootstrap.sh --prefix=/usr/local/Cellar/boost-python/1.65.1 --libdir=/usr/local/Cellar/boost-python/1.65.1/lib --with-libraries=python --with-python=python --with-python-root=/System/Library/Frameworks/Python.framework/Versions/2.7
==> ./b2 --build-dir=build-python --stagedir=stage-python python=2.7 --prefix=/usr/local/Cellar/boost-python/1.65.1 --libdir=/usr/local/Cellar/boost-python/1.65.1/lib -d2 -j4 --layout=tagged --user-config=user-config.jam threading=multi,single link=shared,static
==> ./bootstrap.sh --prefix=/usr/local/Cellar/boost-python/1.65.1 --libdir=/usr/local/Cellar/boost-python/1.65.1/lib --with-libraries=python --with-python=python3 --with-python-root=/usr/local/Cellar/python3/3.6.2/Frameworks/Python.framework/Versions/3.6
==> ./b2 --build-dir=build-python3 --stagedir=stage-python3 python=3.6 --prefix=/usr/local/Cellar/boost-python/1.65.1 --libdir=/usr/local/Cellar/boost-python/1.65.1/lib -d2 -j4 --layout=tagged --user-config=user-config.jam threading=multi,single link=shared,static
ğŸº  /usr/local/Cellar/boost-python/1.65.1: 465 files, 28.4MB, built in 7 minutes 21 seconds
```

Python 2 ç”¨ã¨ Python 3 ç”¨ã®ãƒã‚¤ãƒŠãƒªãŒä¸¡æ–¹ãƒ“ãƒ«ãƒ‰ã•ã‚Œã¦ã„ã¾ã™ã€‚ãƒãƒƒãƒãƒªã§ã™ã€‚

## Python 3 ç”¨ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«ãƒªãƒ³ã‚¯ã™ã‚‹ï¼ˆé‡è¦ï¼‰

- Python 2 ç”¨ã®å ´åˆã¯ `-lboost_python`, `-lboost_numpy` ã‚’æŒ‡å®šã™ã‚‹ã€‚
- Python 3 ç”¨ã®å ´åˆã¯ `-lboost_python3`, `-lboost_numpy3` ã‚’æŒ‡å®šã™ã‚‹ã€‚

Python 2 ç”¨ã¨ Python 3 ç”¨ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¯åå‰ãŒã“ã¨ãªã‚‹ãŸã‚æ³¨æ„ãŒå¿…è¦ã§ã™ã€‚

```console
$ ls /usr/local/lib | grep libboost_python
libboost_python-mt.a
libboost_python-mt.dylib
libboost_python.a
libboost_python.dylib
libboost_python3-mt.a
libboost_python3-mt.dylib
libboost_python3.a
libboost_python3.dylib
```

ãƒ†ã‚¹ãƒˆã¨ã—ã¦ python-multi-array ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ãƒ“ãƒ«ãƒ‰ã—ã¾ã™ã€‚
ãƒ“ãƒ«ãƒ‰ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ setup.py ã§ã™ã€‚<br />
https://github.com/yokaze/python-multi-array

```console
$ # -lboost_python3, -lboost_numpy3 ã ã¨ã¡ã‚ƒã‚“ã¨å‹•ã
$ python3
>>> import multi_array
>>>
```

ã“ã“ã‚’é–“é•ãˆã‚‹ã¨çµå±€ Python 2 ç”¨ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«ãƒªãƒ³ã‚¯ã•ã‚Œã¦ã—ã¾ã„ã€æ‹¡å¼µãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒã†ã¾ãå‹•ãã¾ã›ã‚“ã€‚

```console
$ # -lboost_python, -lboost_numpy
$ python3
>>> import multi_array
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
ImportError: dlopen(multi_array.cpython-36m-darwin.so, 2): Symbol not found: _PyClass_Type
  Referenced from: /usr/local/opt/boost-python/lib/libboost_python.dylib
  Expected in: flat namespace
 in /usr/local/opt/boost-python/lib/libboost_python.dylib
>>>
```

{{< twitter >}}

## å‚è€ƒè³‡æ–™
- A python wrapper for boost::multi_array<br />
  https://github.com/yokaze/python-multi-array
